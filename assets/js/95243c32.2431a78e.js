"use strict";(self.webpackChunkreact_navigation_website_next=self.webpackChunkreact_navigation_website_next||[]).push([["25039"],{45618(e,n,t){t.r(n),t.d(n,{metadata:()=>o,default:()=>h,frontMatter:()=>s,contentTitle:()=>u,toc:()=>f,assets:()=>l});var o=JSON.parse('{"id":"function-after-focusing-screen","title":"Call a function when focused screen changes","description":"In this guide we will call a function or render something on screen focusing. This is useful for making additional API calls when a user revisits a particular screen in a Tab Navigator, or to track user events as they tap around our app.","source":"@site/versioned_docs/version-8.x/function-after-focusing-screen.md","sourceDirName":".","slug":"/function-after-focusing-screen","permalink":"/docs/8.x/function-after-focusing-screen","draft":false,"unlisted":false,"editUrl":"https://github.com/react-navigation/react-navigation.github.io/edit/main/versioned_docs/version-8.x/function-after-focusing-screen.md","tags":[],"version":"8.x","frontMatter":{"id":"function-after-focusing-screen","title":"Call a function when focused screen changes","sidebar_label":"Call a function on focus"},"sidebar":"docs","previous":{"title":"Preventing going back","permalink":"/docs/8.x/preventing-going-back"},"next":{"title":"Navigation Ref","permalink":"/docs/8.x/navigating-without-navigation-prop"}}'),r=t(74848),a=t(28453),c=t(78010),i=t(57250);let s={id:"function-after-focusing-screen",title:"Call a function when focused screen changes",sidebar_label:"Call a function on focus"},u,l={},f=[{value:"Triggering an action with a <code>&#39;focus&#39;</code> event listener",id:"triggering-an-action-with-a-focus-event-listener",level:2},{value:"Triggering an action with the <code>useFocusEffect</code> hook",id:"triggering-an-action-with-the-usefocuseffect-hook",level:2},{value:"Re-rendering screen with the <code>useIsFocused</code> hook",id:"re-rendering-screen-with-the-useisfocused-hook",level:2}];function d(e){let n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"In this guide we will call a function or render something on screen focusing. This is useful for making additional API calls when a user revisits a particular screen in a Tab Navigator, or to track user events as they tap around our app."}),"\n",(0,r.jsx)(n.p,{children:"There are multiple approaches available to us:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Listening to the ",(0,r.jsx)(n.code,{children:"'focus'"})," event with an event listener."]}),"\n",(0,r.jsxs)(n.li,{children:["Using the ",(0,r.jsx)(n.code,{children:"useFocusEffect"})," hook provided by react-navigation."]}),"\n",(0,r.jsxs)(n.li,{children:["Using the ",(0,r.jsx)(n.code,{children:"useIsFocused"})," hook provided by react-navigation."]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"triggering-an-action-with-a-focus-event-listener",children:["Triggering an action with a ",(0,r.jsx)(n.code,{children:"'focus'"})," event listener"]}),"\n",(0,r.jsxs)(n.p,{children:["We can also listen to the ",(0,r.jsx)(n.code,{children:"'focus'"})," event with an event listener. After setting up an event listener, we must also stop listening to the event when the screen is unmounted."]}),"\n",(0,r.jsx)(n.p,{children:"With this approach, we will only be able to call an action when the screen focuses. This is useful for performing an action such as logging the screen view for analytics."}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsxs)(c.A,{groupId:"config",queryString:"config",children:[(0,r.jsx)(i.A,{value:"static",label:"Static",default:!0,children:(0,r.jsx)(n.pre,{"data-name":"Focus event listener","data-snack":"true",children:(0,r.jsx)(n.code,{className:"language-js",metastring:'name="Focus event listener" snack',children:"// codeblock-focus-start\nimport * as React from 'react';\nimport { View } from 'react-native';\n\n// codeblock-focus-end\nimport {\n  useNavigation,\n  createStaticNavigation,\n} from '@react-navigation/native';\nimport {\n  createBottomTabNavigator,\n  createBottomTabScreen,\n} from '@react-navigation/bottom-tabs';\n\n// codeblock-focus-start\nfunction ProfileScreen() {\n  const navigation = useNavigation('Profile');\n\n  React.useEffect(() => {\n    const unsubscribe = navigation.addListener('focus', () => {\n      alert('Screen is focused');\n      // The screen is focused\n      // Call any action\n    });\n\n    // Return the function to unsubscribe from the event so it gets removed on unmount\n    return unsubscribe;\n  }, [navigation]);\n\n  return <View />;\n}\n// codeblock-focus-end\n\nfunction HomeScreen() {\n  return <View />;\n}\n\nconst MyTabs = createBottomTabNavigator({\n  screens: {\n    Home: createBottomTabScreen({\n      screen: HomeScreen,\n    }),\n    Profile: createBottomTabScreen({\n      screen: ProfileScreen,\n    }),\n  },\n});\n\nconst Navigation = createStaticNavigation(MyTabs);\n\nexport default function App() {\n  return <Navigation />;\n}\n"})})}),(0,r.jsx)(i.A,{value:"dynamic",label:"Dynamic",children:(0,r.jsx)(n.pre,{"data-name":"Focus event listener","data-snack":"true",children:(0,r.jsx)(n.code,{className:"language-js",metastring:'name="Focus event listener" snack',children:"// codeblock-focus-start\nimport * as React from 'react';\nimport { View } from 'react-native';\n\n// codeblock-focus-end\nimport { NavigationContainer, useNavigation } from '@react-navigation/native';\nimport { createBottomTabNavigator } from '@react-navigation/bottom-tabs';\n\n// codeblock-focus-start\nfunction ProfileScreen() {\n  const navigation = useNavigation('Profile');\n\n  React.useEffect(() => {\n    const unsubscribe = navigation.addListener('focus', () => {\n      alert('Screen is focused');\n      // The screen is focused\n      // Call any action\n    });\n\n    // Return the function to unsubscribe from the event so it gets removed on unmount\n    return unsubscribe;\n  }, [navigation]);\n\n  return <View />;\n}\n// codeblock-focus-end\n\nfunction HomeScreen() {\n  return <View />;\n}\n\nconst Tab = createBottomTabNavigator();\n\nexport default function App() {\n  return (\n    <NavigationContainer>\n      <Tab.Navigator>\n        <Tab.Screen name=\"Home\" component={HomeScreen} />\n        <Tab.Screen name=\"Profile\" component={ProfileScreen} />\n      </Tab.Navigator>\n    </NavigationContainer>\n  );\n}\n"})})})]}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"/docs/8.x/navigation-events",children:"navigation events guide"})," for more details on the event listener API."]}),"\n",(0,r.jsxs)(n.p,{children:["In most cases, it's recommended to use the ",(0,r.jsx)(n.code,{children:"useFocusEffect"})," hook instead of adding the listener manually. See below for details."]}),"\n",(0,r.jsxs)(n.h2,{id:"triggering-an-action-with-the-usefocuseffect-hook",children:["Triggering an action with the ",(0,r.jsx)(n.code,{children:"useFocusEffect"})," hook"]}),"\n",(0,r.jsxs)(n.p,{children:["React Navigation provides a ",(0,r.jsx)(n.a,{href:"/docs/8.x/use-focus-effect",children:"hook"})," that runs an effect when the screen comes into focus and cleans it up when it goes out of focus. This is useful for cases such as adding event listeners, for fetching data with an API call when a screen becomes focused, or any other action that needs to happen once the screen comes into view."]}),"\n",(0,r.jsx)(n.p,{children:"This is particularly handy when we are trying to stop something when the page is unfocused, like stopping a video or audio file from playing, or stopping the tracking of a user's location."}),"\n",(0,r.jsxs)(c.A,{groupId:"config",queryString:"config",children:[(0,r.jsx)(i.A,{value:"static",label:"Static",default:!0,children:(0,r.jsx)(n.pre,{"data-name":"useFocusEffect hook","data-snack":"true",children:(0,r.jsx)(n.code,{className:"language-js",metastring:'name="useFocusEffect hook" snack',children:"import * as React from 'react';\nimport { View } from 'react-native';\nimport {\n  useFocusEffect,\n  createStaticNavigation,\n} from '@react-navigation/native';\nimport {\n  createBottomTabNavigator,\n  createBottomTabScreen,\n} from '@react-navigation/bottom-tabs';\n\n// codeblock-focus-start\nfunction ProfileScreen() {\n  useFocusEffect(\n    React.useCallback(() => {\n      alert('Screen was focused');\n      // Do something when the screen is focused\n      return () => {\n        alert('Screen was unfocused');\n        // Do something when the screen is unfocused\n        // Useful for cleanup functions\n      };\n    }, [])\n  );\n\n  return <View />;\n}\n// codeblock-focus-end\n\nfunction HomeScreen() {\n  return <View />;\n}\n\nconst MyTabs = createBottomTabNavigator({\n  screens: {\n    Home: createBottomTabScreen({\n      screen: HomeScreen,\n    }),\n    Profile: createBottomTabScreen({\n      screen: ProfileScreen,\n    }),\n  },\n});\nconst Navigation = createStaticNavigation(MyTabs);\n\nexport default function App() {\n  return <Navigation />;\n}\n"})})}),(0,r.jsx)(i.A,{value:"dynamic",label:"Dynamic",children:(0,r.jsx)(n.pre,{"data-name":"useFocusEffect hook","data-snack":"true",children:(0,r.jsx)(n.code,{className:"language-js",metastring:'name="useFocusEffect hook" snack',children:"import * as React from 'react';\nimport { View } from 'react-native';\nimport { NavigationContainer, useFocusEffect } from '@react-navigation/native';\nimport { createBottomTabNavigator } from '@react-navigation/bottom-tabs';\n\n// codeblock-focus-start\nfunction ProfileScreen() {\n  useFocusEffect(\n    React.useCallback(() => {\n      alert('Screen was focused');\n      // Do something when the screen is focused\n      return () => {\n        alert('Screen was unfocused');\n        // Do something when the screen is unfocused\n        // Useful for cleanup functions\n      };\n    }, [])\n  );\n\n  return <View />;\n}\n// codeblock-focus-end\n\nfunction HomeScreen() {\n  return <View />;\n}\n\nconst Tab = createBottomTabNavigator();\n\nexport default function App() {\n  return (\n    <NavigationContainer>\n      <Tab.Navigator>\n        <Tab.Screen name=\"Home\" component={HomeScreen} />\n        <Tab.Screen name=\"Profile\" component={ProfileScreen} />\n      </Tab.Navigator>\n    </NavigationContainer>\n  );\n}\n"})})})]}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"https://reactnavigation.org/docs/use-focus-effect/",children:(0,r.jsx)(n.code,{children:"useFocusEffect"})})," documentation for more details."]}),"\n",(0,r.jsxs)(n.h2,{id:"re-rendering-screen-with-the-useisfocused-hook",children:["Re-rendering screen with the ",(0,r.jsx)(n.code,{children:"useIsFocused"})," hook"]}),"\n",(0,r.jsxs)(n.p,{children:["React Navigation provides a ",(0,r.jsx)(n.a,{href:"/docs/8.x/use-is-focused",children:"hook"})," that returns a boolean indicating whether the screen is focused or not."]}),"\n",(0,r.jsxs)(n.p,{children:["The hook will return ",(0,r.jsx)(n.code,{children:"true"})," when the screen is focused and ",(0,r.jsx)(n.code,{children:"false"})," when our component is no longer focused. This enables us to render something conditionally based on whether the user is on the screen or not."]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"useIsFocused"})," hook will cause our component to re-render when we focus and unfocus a screen. Using this hook component may introduce unnecessary component re-renders as a screen comes in and out of focus. This could cause issues depending on the type of action we're calling on focusing. Hence we recommend to use this hook only if you need to trigger a re-render. For side-effects such as subscribing to events or fetching data, use the methods described above."]}),"\n",(0,r.jsxs)(c.A,{groupId:"config",queryString:"config",children:[(0,r.jsx)(i.A,{value:"static",label:"Static",default:!0,children:(0,r.jsx)(n.pre,{"data-name":"useIsFocused hook","data-snack":"true",children:(0,r.jsx)(n.code,{className:"language-js",metastring:'name="useIsFocused hook" snack',children:"import * as React from 'react';\nimport { View, Text } from 'react-native';\nimport { useIsFocused, createStaticNavigation } from '@react-navigation/native';\nimport {\n  createMaterialTopTabNavigator,\n  createMaterialTopTabScreen,\n} from '@react-navigation/material-top-tabs';\n\n// codeblock-focus-start\nfunction ProfileScreen() {\n  // codeblock-focus-end\n  // This hook returns `true` if the screen is focused, `false` otherwise\n  // codeblock-focus-start\n  const isFocused = useIsFocused();\n\n  return (\n    <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>\n      <Text>{isFocused ? 'focused' : 'unfocused'}</Text>\n    </View>\n  );\n}\n// codeblock-focus-end\n\nfunction HomeScreen() {\n  return <View />;\n}\n\nconst MyTabs = createMaterialTopTabNavigator({\n  screens: {\n    Home: createMaterialTopTabScreen({\n      screen: HomeScreen,\n    }),\n    Profile: createMaterialTopTabScreen({\n      screen: ProfileScreen,\n    }),\n  },\n});\n\nconst Navigation = createStaticNavigation(MyTabs);\n\nexport default function App() {\n  return <Navigation />;\n}\n"})})}),(0,r.jsx)(i.A,{value:"dynamic",label:"Dynamic",default:!0,children:(0,r.jsx)(n.pre,{"data-name":"useIsFocused hook","data-snack":"true",children:(0,r.jsx)(n.code,{className:"language-js",metastring:'name="useIsFocused hook" snack',children:"import * as React from 'react';\nimport { View, Text } from 'react-native';\nimport { NavigationContainer, useIsFocused } from '@react-navigation/native';\nimport { createMaterialTopTabNavigator } from '@react-navigation/material-top-tabs';\n\n// codeblock-focus-start\nfunction ProfileScreen() {\n  // codeblock-focus-end\n  // This hook returns `true` if the screen is focused, `false` otherwise\n  // codeblock-focus-start\n  const isFocused = useIsFocused();\n\n  return (\n    <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>\n      <Text>{isFocused ? 'focused' : 'unfocused'}</Text>\n    </View>\n  );\n}\n// codeblock-focus-end\n\nfunction HomeScreen() {\n  return <View />;\n}\n\nconst Tab = createMaterialTopTabNavigator();\n\nexport default function App() {\n  return (\n    <NavigationContainer>\n      <Tab.Navigator>\n        <Tab.Screen name=\"Home\" component={HomeScreen} />\n        <Tab.Screen name=\"Profile\" component={ProfileScreen} />\n      </Tab.Navigator>\n    </NavigationContainer>\n  );\n}\n"})})})]}),"\n",(0,r.jsxs)(n.p,{children:["This example is also documented in the ",(0,r.jsxs)(n.a,{href:"/docs/8.x/use-is-focused",children:[(0,r.jsx)(n.code,{children:"useIsFocused"})," API documentation"]}),"."]})]})}function h(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},57250(e,n,t){t.d(n,{A:()=>a});var o=t(74848);t(96540);var r=t(34164);function a(e){let{children:n,hidden:t,className:a}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,r.A)("tabItem_Ymn6",a),hidden:t,children:n})}},78010(e,n,t){t.d(n,{A:()=>x});var o=t(74848),r=t(96540),a=t(34164),c=t(88287),i=t(28584),s=t(56347),u=t(99989),l=t(96629),f=t(80618),d=t(41367);function h(e){var n,t;return null!=(n=null==(t=r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){let{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw Error("Docusaurus error: Bad <Tabs> child <".concat("string"==typeof e.type?e.type:e.type.name,'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.'))}))?void 0:t.filter(Boolean))?n:[]}function m(e){let{value:n,tabValues:t}=e;return t.some(e=>e.value===n)}var g=t(19863);function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(n){var o;o=t[n],n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o})}return e}function b(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):(function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t.push.apply(t,o)}return t})(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}),e}function v(e){let{className:n,block:t,selectedValue:r,selectValue:c,tabValues:s}=e,u=[],{blockElementScrollPositionUntilNextRender:l}=(0,i.a_)(),f=e=>{let n=e.currentTarget,t=s[u.indexOf(n)].value;t!==r&&(l(n),c(t))},d=e=>{var n,t;let o=null;switch(e.key){case"Enter":f(e);break;case"ArrowRight":{let t=u.indexOf(e.currentTarget)+1;o=null!=(n=u[t])?n:u[0];break}case"ArrowLeft":{let n=u.indexOf(e.currentTarget)-1;o=null!=(t=u[n])?t:u[u.length-1]}}null==o||o.focus()};return(0,o.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":t},n),children:s.map(e=>{let{value:n,label:t,attributes:c}=e;return(0,o.jsx)("li",b(p({role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>{u.push(e)},onKeyDown:d,onClick:f},c),{className:(0,a.A)("tabs__item","tabItem_LNqP",null==c?void 0:c.className,{"tabs__item--active":r===n}),children:null!=t?t:n}),n)})})}function w(e){let{lazy:n,children:t,selectedValue:c}=e,i=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){let e=i.find(e=>e.props.value===c);return e?(0,r.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,o.jsx)("div",{className:"margin-top--md",children:i.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==c}))})}function j(e){let n=function(e){let n,{defaultValue:t,queryString:o=!1,groupId:a}=e,c=function(e){let{values:n,children:t}=e;return(0,r.useMemo)(()=>{let e=null!=n?n:h(t).map(e=>{let{props:{value:n,label:t,attributes:o,default:r}}=e;return{value:n,label:t,attributes:o,default:r}}),o=(0,f.XI)(e,(e,n)=>e.value===n.value);if(o.length>0)throw Error('Docusaurus error: Duplicate values "'.concat(o.map(e=>e.value).join(", "),'" found in <Tabs>. Every value needs to be unique.'));return e},[n,t])}(e),[i,g]=(0,r.useState)(()=>(function(e){var n;let{defaultValue:t,tabValues:o}=e;if(0===o.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:o}))throw Error('Docusaurus error: The <Tabs> has a defaultValue "'.concat(t,'" but none of its children has the corresponding value. Available values are: ').concat(o.map(e=>e.value).join(", "),". If you intend to show no default tab, use defaultValue={null} instead."));return t}let r=null!=(n=o.find(e=>e.default))?n:o[0];if(!r)throw Error("Unexpected error: 0 tabValues");return r.value})({defaultValue:t,tabValues:c})),[p,b]=function(e){let{queryString:n=!1,groupId:t}=e,o=(0,s.W6)(),a=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:n,groupId:t});return[(0,l.aZ)(a),(0,r.useCallback)(e=>{var n,t;if(!a)return;let r=new URLSearchParams(o.location.search);r.set(a,e),o.replace((n=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.forEach(function(n){var o;o=t[n],n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o})}return e}({},o.location),t=t={search:r.toString()},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):(function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t.push.apply(t,o)}return t})(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}),n))},[a,o])]}({queryString:o,groupId:a}),[v,w]=function(e){let{groupId:n}=e,t=n?"docusaurus.tab.".concat(n):null,[o,a]=(0,d.Dv)(t);return[o,(0,r.useCallback)(e=>{t&&a.set(e)},[t,a])]}({groupId:a}),j=m({value:n=null!=p?p:v,tabValues:c})?n:null;return(0,u.A)(()=>{j&&g(j)},[j]),{selectedValue:i,selectValue:(0,r.useCallback)(e=>{if(!m({value:e,tabValues:c}))throw Error("Can't select invalid tab value=".concat(e));g(e),b(e),w(e)},[b,w,c]),tabValues:c}}(e);return(0,o.jsxs)("div",{className:(0,a.A)(c.G.tabs.container,"tabs-container","tabList__CuJ"),children:[(0,o.jsx)(v,p({},n,e)),(0,o.jsx)(w,p({},n,e))]})}function x(e){let n=(0,g.A)();return(0,o.jsx)(j,b(p({},e),{children:h(e.children)}),String(n))}},28453(e,n,t){t.d(n,{R:()=>c,x:()=>i});var o=t(96540);let r={},a=o.createContext(r);function c(e){let n=o.useContext(a);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);