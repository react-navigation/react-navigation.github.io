"use strict";(self.webpackChunkreact_navigation_website_next=self.webpackChunkreact_navigation_website_next||[]).push([[34903],{5382:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>a,toc:()=>u});const a=JSON.parse('{"id":"compatibility","title":"Compatibility layer","description":"Note: Before following this guide, make sure that you\'ve followed the Getting Started guide to setup React Navigation 5 in your app.","source":"@site/versioned_docs/version-5.x/compatibility.md","sourceDirName":".","slug":"/compatibility","permalink":"/docs/5.x/compatibility","draft":false,"unlisted":false,"editUrl":"https://github.com/react-navigation/react-navigation.github.io/edit/main/versioned_docs/version-5.x/compatibility.md","tags":[],"version":"5.x","frontMatter":{"id":"compatibility","title":"Compatibility layer","sidebar_label":"Compatibility layer"},"sidebar":"docs","previous":{"title":"Glossary of terms","permalink":"/docs/5.x/glossary-of-terms"},"next":{"title":"Troubleshooting","permalink":"/docs/5.x/troubleshooting"}}');var i=n(74848),o=n(28453),r=n(11470),s=n(19365);const l={id:"compatibility",title:"Compatibility layer",sidebar_label:"Compatibility layer"},c=void 0,d={},u=[{value:"What does it handle?",id:"what-does-it-handle",level:3},{value:"What doesn&#39;t it handle?",id:"what-doesnt-it-handle",level:3},{value:"Why should we use it?",id:"why-should-we-use-it",level:3}];function h(e){const t={a:"a",blockquote:"blockquote",code:"code",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsxs)(t.p,{children:["Note: Before following this guide, make sure that you've followed the ",(0,i.jsx)(t.a,{href:"/docs/5.x/getting-started",children:"Getting Started"})," guide to setup React Navigation 5 in your app."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["React Navigation 5 has a completely new API, so our old code using React Navigation 4 will no longer work with this version. If you are not familiar with the new API, you can read about the differences in the ",(0,i.jsx)(t.a,{href:"/docs/5.x/upgrading-from-4.x",children:"upgrade guide"}),". We understand that this can be a lot of work, so we have made a compatibility layer to make this easier."]}),"\n",(0,i.jsxs)(t.p,{children:["To use the compatibility layer, we need to install ",(0,i.jsx)(t.a,{href:"https://github.com/react-navigation/react-navigation/tree/main/packages/compat",children:(0,i.jsx)(t.code,{children:"@react-navigation/compat"})}),":"]}),"\n",(0,i.jsxs)(r.A,{groupId:"npm2yarn",children:[(0,i.jsx)(s.A,{value:"npm",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"npm install @react-navigation/native@^5.x @react-navigation/compat@^5.x @react-navigation/stack@^5.x\n"})})}),(0,i.jsx)(s.A,{value:"yarn",label:"Yarn",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"yarn add @react-navigation/native@^5.x @react-navigation/compat@^5.x @react-navigation/stack@^5.x\n"})})}),(0,i.jsx)(s.A,{value:"pnpm",label:"pnpm",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"pnpm add @react-navigation/native@^5.x @react-navigation/compat@^5.x @react-navigation/stack@^5.x\n"})})}),(0,i.jsx)(s.A,{value:"bun",label:"Bun",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"bun add @react-navigation/native@^5.x @react-navigation/compat@^5.x @react-navigation/stack@^5.x\n"})})})]}),"\n",(0,i.jsx)(t.p,{children:"Then we can make minimal changes in our code to use it:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-diff",children:"-import { createStackNavigator } from 'react-navigation-stack';\n+import { createStackNavigator } from '@react-navigation/stack';\n+import { createCompatNavigatorFactory } from '@react-navigation/compat';\n\n-const RootStack = createStackNavigator(\n+const RootStack = createCompatNavigatorFactory(createStackNavigator)(\n  {\n    Home: { screen: HomeScreen },\n    Profile: { screen: ProfileScreen },\n  },\n  {\n    initialRouteName: 'Profile',\n  }\n);\n"})}),"\n",(0,i.jsxs)(t.p,{children:["If you were importing actions from ",(0,i.jsx)(t.code,{children:"react-navigation"}),", you need to change them to import from ",(0,i.jsx)(t.code,{children:"@react-navigation/compat"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-diff",children:"-import { NavigationActions } from 'react-navigation';\n+import { NavigationActions } from '@react-navigation/compat';\n"})}),"\n",(0,i.jsx)(t.p,{children:"The library exports the following APIs:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Actions:","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"NavigationActions"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"StackActions"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"DrawerActions"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"SwitchActions"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["HOCs","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"withNavigation"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"withNavigationFocus"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["Navigators","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"createSwitchNavigator"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["Compatibility helpers","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"createCompatNavigatorFactory"})," - Takes a navigator with the v5 API and returns a ",(0,i.jsx)(t.code,{children:"createXNavigator"})," with the v4 API."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"createCompatNavigationProp"})," - Takes the v5 ",(0,i.jsx)(t.code,{children:"navigation"})," object along with a ",(0,i.jsx)(t.code,{children:"route"})," object and returns a v4 ",(0,i.jsx)(t.code,{children:"navigation"})," object."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"what-does-it-handle",children:"What does it handle?"}),"\n",(0,i.jsx)(t.p,{children:"The compatibility layer handles various API differences between React Navigation 4 and 5:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Use static configuration API of v4 instead of the component based API."}),"\n",(0,i.jsx)(t.li,{children:"Change signature of methods on the navigation object to match v4."}),"\n",(0,i.jsxs)(t.li,{children:["Add support for ",(0,i.jsx)(t.code,{children:"screenProps"})," which is removed in v5."]}),"\n",(0,i.jsxs)(t.li,{children:["Export action creators such as ",(0,i.jsx)(t.code,{children:"NavigationActions"}),", ",(0,i.jsx)(t.code,{children:"StackActions"}),", ",(0,i.jsx)(t.code,{children:"SwitchActions"})," with same signature as v4."]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"what-doesnt-it-handle",children:"What doesn't it handle?"}),"\n",(0,i.jsx)(t.p,{children:"Due to the dynamic API of React Navigation 5, some functionality possible with the static API of v4 are not possible anymore, and hence the compatibility layer doesn't handle them:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"It doesn't wrap navigator's props or options. This basically means that the options you're passing to a navigator might be different as per breaking changes in the navigators. Refer to the navigator's docs for update options API."}),"\n",(0,i.jsxs)(t.li,{children:["Legacy deep link support by defining ",(0,i.jsx)(t.code,{children:"path"})," in route configuration is not supported. See ",(0,i.jsx)(t.a,{href:"/docs/5.x/deep-linking",children:"deep linking documentation"})," for more details now how to handle deep links."]}),"\n",(0,i.jsxs)(t.li,{children:["Navigating to a navigator doesn't work the same, i.e. we can't navigate to a screen in a navigator that's not rendered already, and params aren't merged to all child screens. See ",(0,i.jsx)(t.a,{href:"/docs/5.x/nesting-navigators",children:"nesting navigators documentation"})," for more details on how to navigate to screens in a different navigator."]}),"\n",(0,i.jsxs)(t.li,{children:["Some methods such as the legacy ",(0,i.jsx)(t.code,{children:"reset"})," method which take an array of actions aren't supported anymore. Unsupported methods will throw errors when using them as well as give type errors if we're using TypeScript."]}),"\n",(0,i.jsxs)(t.li,{children:["It doesn't export ",(0,i.jsx)(t.code,{children:"createAppContainer"}),", so you'll need to use the v5 API for the container (",(0,i.jsx)(t.code,{children:"NavigationContainer"}),"). This also means any features supported by the container need to be migrated to the new API."]}),"\n",(0,i.jsx)(t.li,{children:"If you're using advanced APIs like Redux integration, custom routers and actions etc., they aren't supported anymore and you'll need to remove Redux integration."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"While we have tried our best to make the compatibility layer handle most of the differences, there might be something missing. So make sure to test the code that you've migrated."}),"\n",(0,i.jsx)(t.h3,{id:"why-should-we-use-it",children:"Why should we use it?"}),"\n",(0,i.jsx)(t.p,{children:'Using the compatibility layer allows us to migrate our code to the new version incrementally. Unfortunately we do have to change some code to get the compatibility layer working (see "What doesn\'t it handle") properly, but it still allows majority of our code to remain unchanged. Some of the advantages of using the compatibility layer include:'}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"It allows us to write new code with the new API while integrating with the code using the legacy API, i.e. you can navigate to screens defined with the legacy API from code written with the new API and vice versa."}),"\n",(0,i.jsx)(t.li,{children:"Since it's built on top of v5 which has excellent TypeScript support, the legacy code can also take advantage of the improved type-checking, which will be useful when you want to refactor it into the new API later."}),"\n",(0,i.jsxs)(t.li,{children:["You can get granular with migration, e.g. migrate only few methods in a component to the new API. You still have access to the v5 ",(0,i.jsx)(t.code,{children:"navigation"})," object at ",(0,i.jsx)(t.code,{children:"navigation.original"})," which you can use to gradually migrate the code."]}),"\n",(0,i.jsxs)(t.li,{children:["You have access to new APIs in legacy components, such as ",(0,i.jsx)(t.code,{children:"navigation.setOptions"})," or the new hooks such as ",(0,i.jsx)(t.code,{children:"useFocusEffect"}),"."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"We are committed to help you to make it as easy as possible to upgrade. So please open issues about use cases the compatibility layer doesn't support, so that we can figure out a good migration strategy."})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},19365:(e,t,n)=>{n.d(t,{A:()=>r});n(96540);var a=n(34164);const i={tabItem:"tabItem_Ymn6"};var o=n(74848);function r(e){let{children:t,hidden:n,className:r}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,a.A)(i.tabItem,r),hidden:n,children:t})}},11470:(e,t,n)=>{n.d(t,{A:()=>k});var a=n(96540),i=n(34164),o=n(17559),r=n(23104),s=n(56347),l=n(205),c=n(57485),d=n(31682),u=n(70679);function h(e){var t,n;return null!=(t=null==(n=a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:n.filter(Boolean))?t:[]}function p(e){const{values:t,children:n}=e;return(0,a.useMemo)((()=>{const e=null!=t?t:function(e){return h(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:i}}=e;return{value:t,label:n,attributes:a,default:i}}))}(n);return function(e){const t=(0,d.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error('Docusaurus error: Duplicate values "'+t.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[t,n])}function g(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const i=(0,s.W6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=n?n:null}({queryString:t,groupId:n});return[(0,c.aZ)(o),(0,a.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(i.location.search);t.set(o,e),i.replace(Object.assign({},i.location,{search:t.toString()}))}),[o,i])]}function v(e){const{defaultValue:t,queryString:n=!1,groupId:i}=e,o=p(e),[r,s]=(0,a.useState)((()=>function(e){var t;let{defaultValue:n,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!g({value:n,tabValues:a}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+a.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}const i=null!=(t=a.find((e=>e.default)))?t:a[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:t,tabValues:o}))),[c,d]=m({queryString:n,groupId:i}),[h,v]=function(e){let{groupId:t}=e;const n=function(e){return e?"docusaurus.tab."+e:null}(t),[i,o]=(0,u.Dv)(n);return[i,(0,a.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:i}),x=(()=>{const e=null!=c?c:h;return g({value:e,tabValues:o})?e:null})();(0,l.A)((()=>{x&&s(x)}),[x]);return{selectedValue:r,selectValue:(0,a.useCallback)((e=>{if(!g({value:e,tabValues:o}))throw new Error("Can't select invalid tab value="+e);s(e),d(e),v(e)}),[d,v,o]),tabValues:o}}var x=n(92303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=n(74848);function j(e){let{className:t,block:n,selectedValue:a,selectValue:o,tabValues:s}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.a_)(),d=e=>{const t=e.currentTarget,n=l.indexOf(t),i=s[n].value;i!==a&&(c(t),o(i))},u=e=>{var t;let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{var a;const t=l.indexOf(e.currentTarget)+1;n=null!=(a=l[t])?a:l[0];break}case"ArrowLeft":{var i;const t=l.indexOf(e.currentTarget)-1;n=null!=(i=l[t])?i:l[l.length-1];break}}null==(t=n)||t.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},t),children:s.map((e=>{let{value:t,label:n,attributes:o}=e;return(0,b.jsx)("li",Object.assign({role:"tab",tabIndex:a===t?0:-1,"aria-selected":a===t,ref:e=>{l.push(e)},onKeyDown:u,onClick:d},o,{className:(0,i.A)("tabs__item",f.tabItem,null==o?void 0:o.className,{"tabs__item--active":a===t}),children:null!=n?n:t}),t)}))})}function y(e){let{lazy:t,children:n,selectedValue:o}=e;const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=r.find((e=>e.props.value===o));return e?(0,a.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:r.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==o})))})}function w(e){const t=v(e);return(0,b.jsxs)("div",{className:(0,i.A)(o.G.tabs.container,"tabs-container",f.tabList),children:[(0,b.jsx)(j,Object.assign({},t,e)),(0,b.jsx)(y,Object.assign({},t,e))]})}function k(e){const t=(0,x.A)();return(0,b.jsx)(w,Object.assign({},e,{children:h(e.children)}),String(t))}},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>s});var a=n(96540);const i={},o=a.createContext(i);function r(e){const t=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(o.Provider,{value:t},e.children)}}}]);